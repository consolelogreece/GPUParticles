<!-- This is a learning exercise heavily inspired and helped by: https://blog.mapbox.com/how-i-built-a-wind-map-with-webgl-b63022b5537f -->

<body style="width: 100%; height:100%; background-color: #111;">
    <canvas id="c"></canvas>
</body>

<script src="./utils.js"></script>
<script src="./Shaders/Draw_Particles_Shader.js"></script>
<script src="./Shaders/Fade_Screen_Texture_Shader.js"></script>
<script src="./Shaders/Draw_To_Screen_Texture_Shader.js"></script>
<script src="./Shaders/Update_Particles_Shader.js"></script>
<script src="./Scripts/ParticlesExperiment.js"></script>
<link rel="stylesheet" type="text/css" href="styles.css">

<script>
    var requestAnimationFrameReference;
    function draw()
    {
        particles.draw();
        
        // This tells the browser to keep rerunning this function whenever it deems fit (typically the refresh rate of the monitor).
        requestAnimationFrameReference = requestAnimationFrame(draw);
    }

    function resize()
    {
        // Keep it square because it looks cooler.
        var dimension = window.innerWidth;
        if (window.innerHeight < window.innerWidth) dimension = window.innerHeight;

        var dimensionSizePixels = dimension / 100 * 95;

        particles.resize(dimensionSizePixels, dimensionSizePixels)

        window.cancelAnimationFrame(requestAnimationFrameReference);

        draw();
    }

    var particles = new ParticlesExperiment(document.getElementById("c").getContext("webgl2", {preserveDrawingBuffer: false}));

    window.addEventListener('resize', resize); 

    resize();
    draw();
</script>